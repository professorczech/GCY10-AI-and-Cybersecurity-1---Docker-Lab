# SOC Intro Lab â€“ Student Guide

Welcome to your **SOC-in-a-Box**. This is a self-contained cybersecurity lab running on your machine via Docker.

**The Environment:**
- **Desktop:** Ubuntu Linux (accessed via browser)
- **Email Client:** Claws Mail
- **AI Ops:** OLLAMA + Open WebUI (Local LLM Chat)
- **Tools:** GoPhish (Phishing), Shuffle (SOAR), Kibana (Logs), Firefox.

---

## 1. Credentials

| User | Username | Password | Role |
| :--- | :--- | :--- | :--- |
| **Student 1** | `alice` | `Password123!` | Primary Analyst / Victim |
| **Student 2** | `bob` | `Password123!` | Secondary Target |
| **Root/Admin** | `root` | `Password123!` | System Administration |

---

## 2. Launching the Lab

1. Open PowerShell or Terminal.
2. Navigate to the folder containing these files.
3. Run the deployment command:
   ```bash
   docker compose up -d
   ```
4. **Wait 3-5 Minutes!** - Elasticsearch and the AI models need time to initialize.

---

## 3. Accessing the Lab

### The Desktop
Open your web browser (Chrome/Edge/Firefox) and go to:
> **http://localhost:6080**

- You will see the Ubuntu XFCE desktop.
- To switch users, open a terminal and type `su bob` (Password: `Password123!`).

### The Tools
All tools are accessible *inside* the Ubuntu Desktop browser (Firefox) or from your Windows browser:

| Tool | Internal URL (Inside Ubuntu) | External URL (Windows) |
| :--- | :--- | :--- |
| **Kibana (Logs)** | http://soc-kibana:5601 | http://localhost:5601 |
| **Open WebUI (AI)**| http://soc-open-webui:8080 | http://localhost:3000 |
| **GoPhish Admin** | https://127.0.0.1:3333 | https://localhost:3333 |
| **Shuffle (SOAR)**| http://soc-shuffle-frontend:3001 | http://localhost:3001 |
| **Phishing Server**| http://localhost:8080 | http://localhost:8080 |

---

## 4. Mailbox Configurations (Claws Mail)

If Claws Mail does not auto-configure, or if you need to set it up manually, use these exact settings.

### **Alice's Profile**
* **Account Name:** `Alice`
* **Protocol:** `IMAP4`
* **Server for Receiving:** `localhost`
* **SMTP Server (Send):** `localhost`
* **User ID:** `alice`
* **Password:** `Password123!`

**Advanced Settings:**
* **SSL/TLS (Receive):** Don't use SSL
* **SSL/TLS (Send):** Don't use SSL
* **SMTP Authentication:** [x] Checked (Use same credentials as receiving)

### **Bob's Profile**
* **Account Name:** `Bob`
* **Protocol:** `IMAP4`
* **Server for Receiving:** `localhost`
* **SMTP Server (Send):** `localhost`
* **User ID:** `bob`
* **Password:** `Password123!`

**Advanced Settings:**
* **SSL/TLS (Receive):** Don't use SSL
* **SSL/TLS (Send):** Don't use SSL
* **SMTP Authentication:** [x] Checked (Use same credentials as receiving)

---

## 5. Lab Tasks

### Task A: Verify Email & Phishing
1. Open **Claws Mail**.
2. Check the **Inbox**. You should see simulated emails generated by the lab script:
   - *URGENT: 2FA Reset Required* (Phishing)
   - *Benefits Enrollment* (Legitimate)
3. **Analyze Headers:** Right-click an email > **View Source** to inspect the SPF headers and X-Mailer tags.

### Task B: Interacting with AI (OLLAMA)
1. Open Firefox inside the Ubuntu Desktop.
2. Go to `http://soc-open-webui:8080`.
3. Create an account (local only, use any email/password).
4. Select the **qwen3:1.7b** model from the dropdown.
5. Ask it to analyze a phishing email body.

### Task C: Launch a Custom Phishing Campaign
1. Go to **GoPhish Admin** (`https://localhost:3333`).
2. Log in (Default: `admin`).
   - *Note: To find the temporary password, open a terminal and run:* `docker logs soc-student-desktop | grep "Password"`
3. Create a **Sending Profile**:
   - Host: `localhost:25`
   - From: `security@lab.local`
4. Launch a Campaign sending to `bob@lab.local`.

### Task D: Threat Hunting in ELK
1. Go to **Kibana** (`http://localhost:5601`).
2. Go to **Stack Management** > **Data Views**.
3. Create a data view for `filebeat-*`.
4. Go to **Discover**.
5. Search for `event.dataset: "system.syslog"` to see the Ransomware simulation logs.

---

## Troubleshooting
- **"Auth Process Broken" Error:** This means the mail server cannot read the password file. Ensure you have rebuilt the container using `docker compose build --no-cache`.
- **Kibana Red status?** Elasticsearch is heavy. Wait 2 more minutes and refresh.
- **NoVNC White Screen?** Use an Incognito window or press **Ctrl+F5** to clear the cache.
- **Stop the Lab:** Run `docker compose down`.